import yara
import os

memory_dump = 'stuxnet.vmem'

# YARA rules compile
rules = yara.compile('yara_rules.yar')


def scan_file(file_path):
    matches = rules.match(file_path)
    return matches


# memory analysis
if os.path.exists(memory_dump):
    print(f"Scanning {memory_dump}...")
    matches = scan_file(memory_dump)

    if matches:
        print("Malware signatures detected:")
        for match in matches:
            print(f"Rule: {match.rule}, Tags: {match.tags}, Meta: {match.meta}")
    else:
        print("No malware signatures detected.")
else:
    print(f"File {memory_dump} does not exist.")
